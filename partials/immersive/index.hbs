<section class="immersive{{#unless @custom.immersive_show_counters}} immersive--hide-counters{{/unless}}" 
         data-immersive
         data-immersive-autoplay="{{@custom.immersive_autoplay}}"
         data-immersive-interval="{{@custom.immersive_interval_ms}}"
         data-rail-style="{{@custom.immersive_rail_style}}"
         data-rail-position="{{@custom.immersive_rail_position}}"
         data-rail-size="{{@custom.immersive_rail_size}}"
         style="--immersive-overlay-opacity: {{@custom.immersive_overlay_opacity}}; --immersive-blur-px: {{@custom.immersive_blur_px}}px;">
    
    <!-- Slides container -->
    <div class="immersive__slides">
        {{#get "posts" limit=@custom.immersive_max_posts as |latest_posts|}}
            {{#foreach latest_posts}}
                {{> "immersive/slide"}}
            {{/foreach}}
        {{/get}}
    </div>
    
    <!-- About overlay (uses theme headers + optional subscribe) -->
    <section class="imm-about" role="region" aria-label="About this site">
        <div class="imm-about__inner">
            {{#if @custom.primary_header}}
                <h1 class="imm-about__title" id="imm-about-title">{{{@custom.primary_header}}}</h1>
            {{/if}}
            
            {{#if @custom.secondary_header}}
                <p class="imm-about__subtitle">{{{@custom.secondary_header}}}</p>
            {{/if}}
            
            {{#if @site.members_enabled}}
                {{#unless @member}}
                    <div class="imm-about__subscribe" data-portal>
                        heyyou@youreawesome.com
                        <span class="imm-about__button">Subscribe</span>
                    </div>
                {{/unless}}
            {{/if}}
            
            <a href="/tag/all-posts/" class="imm-about__browse-link">
                <span>Browse All Posts</span>
                <svg class="imm-about__arrow" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>
        </div>
    </section>
    
    <!-- Current slide counter -->
    <div class="immersive__counter immersive__counter--left">
        <span data-counter-current>01</span>
    </div>
    
    <!-- Total slides counter -->
    <div class="immersive__counter immersive__counter--right">
        <span data-counter-total>00</span>
    </div>
    
    <!-- Dynamic navigation rail -->
    {{#get "posts" limit=@custom.immersive_max_posts as |latest_posts|}}
        <nav class="immersive__rail" 
             data-rail-position="{{@custom.immersive_rail_position}}"
             data-rail-size="{{@custom.immersive_rail_size}}"
             data-rail-style="{{@custom.immersive_rail_style}}"
             role="tablist" 
             aria-label="Slide navigation">
            {{#foreach latest_posts}}
                <button class="immersive__item{{#if @first}} is-active{{/if}}" 
                        data-item="{{@index}}"
                        data-number="{{@number}}"
                        data-title="{{title}}"
                        role="tab"
                        aria-selected="{{#if @first}}true{{else}}false{{/if}}"
                        aria-controls="slide-{{@index}}"
                        aria-label="Go to slide {{@number}}: {{title}}"
                        tabindex="{{#if @first}}0{{else}}-1{{/if}}">
                    <span class="immersive__item-content">{{title}}</span>
                    <span class="immersive__item-number">{{@number}}</span>
                </button>
            {{/foreach}}
        </nav>
    {{/get}}
    
    <!-- Help overlay -->
    {{> "immersive/help"}}
    
</section>